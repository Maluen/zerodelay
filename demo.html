<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Zerodelay.js</title>
        <style>
        </style>
    </heed>
    <body>
        <div id="content">
            <p>
                <a id="respond" href="#">Click me during loading!</a>
                <p>Done <span id="done">0</span></p>
            </p>
            <textarea id="log" rows="30" cols="20"></textarea>
        </div>

        <script src="lib/setImmediate.js"></script>
        <script src="https://rawgit.com/Maluen/zerodelay/master/src/zerodelay.js"></script>
        <script>
        var defer = zerodelay.defer;

        var respond = document.getElementById("respond");
        respond.addEventListener("click", function(e) {
            alert('Yup, sir?');
            return false;
        });

        var log = document.getElementById("log");
        var done = document.getElementById("done");
        var doneNum = 0;

        var categories = ['foo', 'bar', 'some'];
        categories.forEach(function(category) {
            for (var i=0; i<1000; i++) {
                defer(function() {
                    log.value += '\n Running "'+category+'"';
                    done.innerHTML = ++doneNum;
                }, this, category);
            }
        });
        </script>
    </body>
</html>